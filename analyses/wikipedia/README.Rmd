---
title: "Global interest in Catalan and Spanish politicians: what Wikipedia tells us"
output: github_document
---


```{r setup, include=FALSE, echo = FALSE}
# Basic knitr options
library(knitr)
opts_chunk$set(comment = NA, 
               echo = FALSE, 
               warning = FALSE, 
               message = FALSE, 
               error = TRUE, 
               cache = FALSE,
               fig.path = 'figures/')
```

```{r}
source('prepare_data.R')
```

# Introduction

[Wikipedia](https://www.wikipedia.org/), a popular online encyclopedia, makes data on page visits [publicly available](https://tools.wmflabs.org/pageviews/?project=en.wikipedia.org&platform=all-access&agent=user&range=latest-20&pages=Cat|Dog). Wikipedia page view data is very interesting to analysts, since it is a good measure of language-specific interest in a topic or person over time. 

For example, if we examine daily English-language views of [Josep Borrell's Wikipedia page](https://en.wikipedia.org/wiki/Josep_Borrell), 3 peaks clearly emerge.

```{r}
borrell_plot()
```

The first peak coincides with his being named Foreign Minister for the Sánchez government, a time at which many English speakers may have become interested in him. The second peak, in September, coincides with his [BBC interview](https://twitter.com/joethebrew/status/1039573047634743300) and some comments he made regarding Donald Trump's proposed Mexico wall. And the third peak happened in November, when he accused Jordi Salvador (a ERC congressman) of spitting on him. Notably, English-language searches for Borrell remained high through the rest of November, coinciding also with the Abengoa fines and supremacist comments about native Americans.

Wikipedia data is a good indicator of general interest in a person. And since we can segregate the data by language, we can approximate where that interest comes from.

Let's use Wikipedia data to gauge interest in Catalan and Spanish political figures over time.

## Question

How much global interest is there in Catalan and Spanish politicians?

# Methods

We gathered daily page-view data from three Wikipedia language platforms - English, Spanish, and Catalan - on 24 political figures:

```{r, results = 'asis'}
cat(paste0(sort(unique(pv$person)), collapse = '  \n'))
```

Of our pool of 24, 17 are sovereigntists, 8 are in exile, and 9 are in prison. All are politicians except Valtònyc, who is a musician.

We compared overall page views and views over time between different politicians.

# Results

The below shows the total number of language-specific Wikipedia page-views for each of the 24 people analyzed. 

```{r}
make_wiki_plot(since = '2018-01-01') +
  labs(title = '2018 Wikipedia page views')
```

There are several interesting dimensions to these data worth highlighting:

1. Pedro Sánchez is the politician who generates most interest in Spanish.  
2. Carles Puigdemont, however, generates more interest than Sánchez in both English and Catalan.

3. Catalan unionists politicians (Iceta, Arrimadas, García Albiol) generate more interest in Spanish than in Catalan or English.

4. Political figures in prison and exile generate more English-language interest than non-exiled Catalan unionist politicians.

5. Drastic differences in the ratio of Spanish language and Catalan language searches for certain individuals suggests a "disconnect" for many Spaniards from Catalan politics, and for many Catalans from Spanish politics.

## Catalan vs. Spanish

The fifth point merits further explanation. Certain Catalan politicians generate almost no interest in Spanish, whereas certain Spanish politicians generate almost no interest in Catalan. The below chart, for example, shows Spanish vs. Catalan page views

```{r}
ratio_plot() +
  labs(title = 'Wikipedia page-views, 2017: Catalan vs. Spanish')
```

Another way to view the above data is the ratio of views in Catalan to Spanish (and vice-versa):

```{r}
ratio_plot(ratio = T) +
  labs(title = 'Wikipedia page-views, 2017: Catalan vs. Spanish')
```

Pages for the Catalan political prisoners and exiles are viewed much more in Catalan than in Spanish, whereas pages for Catalan unionist politicians (García Albiol, Iceta, Arrimadas, Borrell) are viewed much more in Spanish. Only the very well-known Catalan pro-independence politicians get more views in Spanish than in Catalan.

## English page-views

One of the most striking findings of this analysis is how much English-language traffic is generated by the Catalan political prisoners and exiles. The below shows the total number 2018 page-views for our sample:

```{r}
x <- make_wiki_plot(filter_language = 'English', return_table = T)
x <- x %>% arrange(desc(views))
x %>%
  dplyr::rename(Person = person,
                Views = views) %>%
  dplyr::select(-language) %>%
  kable
```

Here's the same data in visual format:

```{r}
make_wiki_plot(filter_language = 'English') +
  labs(title = 'Total 2018 Wikipedia page views (English only)') +
  geom_text(aes(label = views),
            nudge_y = 20000,
            alpha = 0.6,
            size = 2) +
  theme(legend.position = 'none')
```

Here's what's striking about the above:

- Carles Puigdemont, who according to Spain has no political role, got more than 4 times as many English-language page-views as the President of Spain (Pedro Sánchez).  
- 2 Catalan political prisoners (Oriol Junqueras and Raül Romeva) received more English-language page-views than several national Spanish politicians (Albert Rivera and Pablo Casado)

Another striking element is the ambiguous effect of prison vs. exile in terms of international (English-language) impact. The below shows English-language page views, colored by exile vs. prison status.

```{r}
barplot(1:10)
```




# Catalan-language plots

```{r}
borrell_plot()
```

```{r}
make_wiki_plot(since = '2018-01-01', language = 'ca') +
  labs(title = 'Visites de Wikipedia, 2018')
```


```{r}
ratio_plot() +
  labs(title = 'Visites de Wikipedia, 2017: Català vs. Castellà')
```


```{r}
ratio_plot(ratio = T) +
  labs(title = 'Visites de Wikipedia, 2017: Català vs. Castellà')
```

```{r}
make_wiki_plot(filter_language = 'English') +
  labs(title = '2018 visites de pàgines Wikipedia (només anglès)') +
  geom_text(aes(label = views),
            nudge_y = 20000,
            alpha = 0.6,
            size = 2) +
  theme(legend.position = 'none')

```